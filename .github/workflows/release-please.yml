name: release-please

on:
  push:
    branches:
      - main        # â† ãƒ‡ãƒ•ã‚©ãƒ–ãƒ©ãƒ³ãƒã«åˆã‚ã›ã¦

permissions:
  contents: write
  pull-requests: write
  issues: write

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ Checkout repository
        uses: actions/checkout@v3
        with:
          fetch-depth: 0      # ã‚¿ã‚°å–å¾—ã«å¿…é ˆ

      # â”€â”€ ãƒ‡ãƒãƒƒã‚°ï¼šãƒªãƒæ§‹é€ ã‚’å‡ºåŠ› â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: ğŸ•µï¸ Show file tree
        run: |
          echo "PWD: $(pwd)"
          echo "===== ls -R ====="
          ls -R

      # â”€â”€ package.json ãŒæœ¬å½“ã«ã‚ã‚‹ã‹ç°¡æ˜“ãƒã‚§ãƒƒã‚¯ â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: ğŸ§ª Sanity check
        run: |
          test -f Packages/src/package.json && echo "âœ… package.json OK"

      # â”€â”€ releaseâ€‘please æœ¬ç•ª â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: ğŸš€ Run releaseâ€‘please
        uses: googleapis/release-please-action@v3
        with:
          path: Packages/src
          release-type: node
          package-name: "io.github.hatayama.unitypocketmcp"
          token: ${{ secrets.GITHUB_TOKEN }}